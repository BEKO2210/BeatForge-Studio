---
phase: 12-platform-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - vite.config.ts
  - src/main.tsx
  - index.html
  - public/manifest.json
autonomous: true

must_haves:
  truths:
    - "App loads without network after first visit"
    - "App can be installed as PWA on mobile"
    - "Service worker caches all assets"
  artifacts:
    - path: "vite.config.ts"
      provides: "Vite PWA plugin configuration"
      contains: "VitePWA"
    - path: "public/manifest.json"
      provides: "Web app manifest for PWA"
      contains: "name"
    - path: "src/main.tsx"
      provides: "Service worker registration"
  key_links:
    - from: "vite.config.ts"
      to: "public/manifest.json"
      via: "PWA plugin manifest config"
---

<objective>
Add Progressive Web App (PWA) capability with service worker for offline support.

Purpose: Enable the app to work offline after first load and be installable on mobile devices.
Output: PWA configuration with service worker caching all assets.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@vite.config.ts
@src/main.tsx
@index.html
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure Vite PWA plugin</name>
  <files>package.json, vite.config.ts</files>
  <action>
    1. Install vite-plugin-pwa: `npm install -D vite-plugin-pwa`
    2. Update vite.config.ts to add VitePWA plugin with:
       - generateSW mode (automatic service worker generation)
       - registerType: 'autoUpdate' (auto-update on new versions)
       - workbox config to cache all assets (js, css, html, images, fonts)
       - Include manifest config inline or reference manifest.json
    3. Set injectManifest: false (use generateSW for simplicity)

    Avoid: Don't use injectManifest mode - too complex for this use case.
  </action>
  <verify>npm run build succeeds with SW generated in dist/</verify>
  <done>Vite PWA plugin installed and configured</done>
</task>

<task type="auto">
  <name>Task 2: Create web app manifest</name>
  <files>public/manifest.json, index.html</files>
  <action>
    1. Create public/manifest.json with:
       - name: "BeatForge Studio"
       - short_name: "BeatForge"
       - description: "Browser-based music visualizer creator"
       - start_url: "/Meet-the-Beat-main/" (matches base path)
       - display: "standalone"
       - background_color: "#0a0a0a" (matches app dark theme)
       - theme_color: "#646cff" (accent color)
       - icons: array with 192x192 and 512x512 PNG icons (use placeholder SVG converted or simple icons)
    2. Update index.html:
       - Add <link rel="manifest" href="/Meet-the-Beat-main/manifest.json">
       - Add <meta name="theme-color" content="#646cff">
       - Add apple-touch-icon link for iOS

    Note: For icons, we can use a simple generated icon or placeholder. The important thing is the manifest structure.
  </action>
  <verify>manifest.json loads correctly when dev server runs</verify>
  <done>Web app manifest exists and is linked in HTML</done>
</task>

<task type="auto">
  <name>Task 3: Add PWA icons</name>
  <files>public/icon-192.png, public/icon-512.png, public/apple-touch-icon.png</files>
  <action>
    1. Create simple app icons for PWA:
       - Generate SVG icon with "BF" text on dark background with accent gradient
       - Create 192x192 and 512x512 versions
       - Create 180x180 apple-touch-icon.png

    Since we can't generate actual PNG files, create an SVG icon that can be referenced.
    Update manifest.json to use the SVG as fallback:
    - Use inline SVG data URL or reference existing vite.svg as temporary icon
    - Add purpose: "any maskable" for Android adaptive icons

    Alternative: Reference vite.svg (already in public/) as temporary icon until proper branding is created.
  </action>
  <verify>Icons referenced in manifest.json exist or are valid data URLs</verify>
  <done>PWA icons available for installation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] dist/sw.js exists after build
- [ ] manifest.json is valid JSON
- [ ] Service worker registers on page load (check DevTools > Application)
</verification>

<success_criteria>

- All tasks completed
- PWA plugin configured in Vite
- Manifest created with proper metadata
- App can be installed as PWA (check browser install prompt)
- Service worker caches assets for offline use
  </success_criteria>

<output>
After completion, create `.planning/phases/12-platform-polish/12-01-SUMMARY.md`
</output>
