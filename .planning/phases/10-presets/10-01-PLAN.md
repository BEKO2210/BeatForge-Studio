# Plan: Preset System

---
truths:
  - Presets compose existing configuration types (background, text, visualizer, effects)
  - Four presets: TikTok, YouTube, Lyric Video, Club Visualizer
  - Each preset defines aspect ratio, visualizer settings, text defaults, background, effects
  - Users can tweak preset parameters after applying
artifacts:
  - src/presets/types.ts - PresetConfig type and preset type definitions
  - src/presets/presets.ts - Four preset definitions
  - src/presets/index.ts - Barrel exports
  - src/App.tsx - Preset selector UI integration
key_links: []
autonomous: true
---

## Objective

Implement a preset system that provides four distinct visual styles (TikTok, YouTube, Lyric Video, Club Visualizer), each composing existing configuration types into cohesive themes. Users can select a preset and optionally tweak parameters.

## Execution Context

```
@src/visualizers/types.ts — CircularSettings, ClubSettings, VisualizerType
@src/text/types.ts — TextLayer, TextStyle, BeatEffectSettings
@src/background/types.ts — BackgroundConfig, GradientBackground
@src/effects/types.ts — EffectsConfig, CameraShakeConfig, VignetteConfig
@src/App.tsx — Current app structure for preset integration
```

## Context

Phase 10 builds on all previous systems (visualizers, text, background, effects) by composing their configurations into opinionated presets. Each preset defines:

1. **Aspect Ratio**: Canvas dimensions (9:16 for TikTok, 16:9 for YouTube, etc.)
2. **Visualizer**: Which visualizer type and its settings
3. **Background**: Color/gradient configuration matching the aesthetic
4. **Text**: Default text layer with appropriate styling
5. **Effects**: Camera shake and vignette tuned for the preset

Requirements to satisfy:
- PRE-01: TikTok preset (9:16, high energy, bold text, constant movement)
- PRE-02: YouTube preset (16:9, cinematic, calm transitions, minimal text)
- PRE-03: Lyric Video preset (text-centric, karaoke animation, soft backgrounds)
- PRE-04: Club Visualizer preset (dark, neon, strong equalizer, rave aesthetic)
- PRE-05: Preset customization and parameter tweaking (via existing settings panels)

## Tasks

### Wave 1: Types and Definitions

#### Task 1.1: Create preset type definitions
**File**: `src/presets/types.ts`

Define the PresetConfig interface that composes all configuration types:

```typescript
import type { VisualizerType, CircularSettings, ClubSettings } from '../visualizers/types';
import type { TextLayer } from '../text/types';
import type { BackgroundConfig } from '../background/types';
import type { EffectsConfig } from '../effects/types';

export type PresetId = 'tiktok' | 'youtube' | 'lyric' | 'club';

export interface AspectRatio {
  width: number;
  height: number;
  label: string; // "9:16", "16:9", etc.
}

export interface PresetConfig {
  id: PresetId;
  name: string;
  description: string;
  aspectRatio: AspectRatio;
  visualizer: {
    type: VisualizerType;
    circularSettings?: CircularSettings;
    clubSettings?: ClubSettings;
  };
  background: BackgroundConfig;
  defaultTextLayers: TextLayer[];
  effects: EffectsConfig;
}
```

#### Task 1.2: Create preset definitions
**File**: `src/presets/presets.ts`

Define the four presets with distinct visual languages:

**TikTok Preset** (PRE-01):
- Aspect ratio: 9:16 (1080x1920)
- Visualizer: circular with high energy settings (fast rotation, high sensitivity)
- Background: dark gradient with purple/pink tones
- Text: Bold, centered, large font, high beat reactivity
- Effects: Strong camera shake, intense vignette

**YouTube Preset** (PRE-02):
- Aspect ratio: 16:9 (1920x1080)
- Visualizer: equalizer-v2 (club) with calm settings
- Background: cinematic dark with subtle blue gradient
- Text: Minimal, bottom-left, smaller font, subtle beat effects
- Effects: Gentle camera shake, soft vignette

**Lyric Video Preset** (PRE-03):
- Aspect ratio: 16:9 (1920x1080)
- Visualizer: waveform (subtle, background element)
- Background: Soft pastel gradient
- Text: Center-positioned, medium size, glow animation, karaoke-style settings
- Effects: No camera shake, soft vignette

**Club Visualizer Preset** (PRE-04):
- Aspect ratio: 16:9 (1920x1080)
- Visualizer: equalizer-v2 with max bass gain, high sensitivity
- Background: Pure black (#000000)
- Text: Neon cyan/magenta, bottom, strong glow
- Effects: Maximum camera shake, strong vignette

#### Task 1.3: Create barrel exports
**File**: `src/presets/index.ts`

Export all types and preset definitions.

### Wave 2: Integration

#### Task 2.1: Integrate preset selector into App
**File**: `src/App.tsx`

Add preset selection:
1. Add state for current preset ID
2. Create preset selector dropdown/buttons above the visualizer
3. When preset changes:
   - Update canvas aspect ratio (may need to add aspectRatio state)
   - Apply visualizer type and settings
   - Apply background config
   - Apply default text layers
   - Apply effects config (passed to VisualizerContainer)
4. Existing settings panels allow tweaking after preset applied (satisfies PRE-05)

Key integration points:
- `setSelectedVisualizer` for visualizer type (already exists in VisualizerContainer)
- Background config prop to VisualizerContainer (already exists)
- Text layers prop to VisualizerContainer (already exists)
- Need to add aspect ratio handling

#### Task 2.2: Add aspect ratio support
**File**: `src/App.tsx` and CSS

Add aspect ratio control:
1. Add `aspectRatio` state initialized from preset
2. Apply aspect ratio via CSS custom property or inline style on visualizer wrapper
3. Update canvas dimensions when aspect ratio changes

## Verification

- [ ] Four presets defined with distinct visual styles
- [ ] Preset selector visible in UI
- [ ] Selecting TikTok preset: canvas becomes 9:16, circular visualizer, bold text
- [ ] Selecting YouTube preset: canvas is 16:9, club visualizer, minimal text
- [ ] Selecting Lyric preset: canvas is 16:9, waveform, centered text with glow
- [ ] Selecting Club preset: canvas is 16:9, max energy equalizer, neon text
- [ ] Existing settings panels still work after preset applied (PRE-05)
- [ ] No TypeScript errors

## Success Criteria

1. All four presets provide distinct, recognizable visual styles
2. Presets correctly compose visualizer, background, text, and effects settings
3. Aspect ratio changes work correctly for 9:16 and 16:9
4. Users can modify settings after applying a preset (PRE-05)
5. UI is intuitive - preset selection is discoverable

## Output

On completion, create SUMMARY with:
- Preset system architecture
- Four preset configurations
- Integration points in App.tsx
- How users can customize after applying preset
