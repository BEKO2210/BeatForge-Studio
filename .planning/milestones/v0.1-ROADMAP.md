# Milestone v0.1: Alpha

**Status:** SHIPPED 2025-01-16
**Phases:** 1-12
**Total Plans:** 19

## Overview

Build a browser-based music visualizer creator from the ground up. Start with audio infrastructure and canvas rendering, layer in visualizers and beat-reactive animations, then add text/background systems, presets, and finally export and platform polish. Each phase delivers a working, testable capability that builds toward the full product.

## Phases

### Phase 1: Foundation

**Goal**: Project scaffolding with Vite + React + TypeScript, basic component structure, and development workflow
**Depends on**: Nothing (first phase)
**Requirements**: PLT-05
**Plans**: 1

Plans:
- [x] 01-01: Vite + React + TypeScript project setup

**Details:**
- Vite 7.x with React 19 (latest stable)
- Strict TypeScript with noUncheckedIndexedAccess
- GitHub Pages base path configuration
- Dark-themed app shell

### Phase 2: Audio Engine

**Goal**: Users can upload audio files and control playback
**Depends on**: Phase 1
**Requirements**: AUD-01, AUD-04
**Plans**: 1

Plans:
- [x] 02-01: Audio upload, playback, and transport controls

**Details:**
- Lazy AudioContext initialization for autoplay policy
- useMemo with key pattern for AudioEngine lifecycle
- State lifted to App.tsx - AudioPlayer receives all state as props

### Phase 3: Beat Detection

**Goal**: Real-time audio analysis providing beat and frequency data
**Depends on**: Phase 2
**Requirements**: AUD-02, AUD-03
**Plans**: 2

Plans:
- [x] 03-01: Beat detection infrastructure with AnalyserNode
- [x] 03-02: useBeatDetector hook integration

**Details:**
- AnalyserNode fftSize 2048, smoothingTimeConstant 0.8
- Energy-based beat detection with 1.3x threshold and 100ms cooldown
- Bass frequency (20-250Hz) as primary beat indicator
- Polling via requestAnimationFrame for 60 FPS

### Phase 4: Canvas Renderer

**Goal**: Rendering engine capable of drawing and animating visual elements at 60 FPS
**Depends on**: Phase 1
**Requirements**: PRV-01
**Plans**: 1

Plans:
- [x] 04-01: Canvas renderer with devicePixelRatio scaling

**Details:**
- devicePixelRatio scaling for crisp rendering on high-DPI displays
- Set-based render callbacks allowing multiple visualizers
- ResizeObserver on parent element for responsive sizing

### Phase 5: Visualizers

**Goal**: Core visualizers (equalizer, waveform, circular spectrum) render audio data
**Depends on**: Phase 3, Phase 4
**Requirements**: VIS-01, VIS-02, VIS-03
**Plans**: 3

Plans:
- [x] 05-01: Visualizer infrastructure and data normalization
- [x] 05-02: Three visualizer components
- [x] 05-03: VisualizerContainer with selector UI

**Details:**
- Equalizer: 80 time columns scrolling spectrogram
- Waveform: 400 samples with mirror reflection
- Circular: 128 lines with 0.3 rad/s rotation and 12-frame trails
- Temporal flow in all visualizers (not just reactive meters)

### Phase 6: Beat Reactivity

**Goal**: Visual elements respond dynamically to beats and audio energy
**Depends on**: Phase 3, Phase 5
**Requirements**: FX-01
**Plans**: 2

Plans:
- [x] 06-01: useBeatReaction hook and Equalizer integration
- [x] 06-02: Waveform and Circular beat reactivity

**Details:**
- 150ms decay with easeOutExpo for Equalizer
- 200ms decay for Waveform (smooth wave feel)
- 180ms decay for Circular (responsive feel)
- Canvas shadowBlur for glow effect at reaction > 0.1
- Human-verified beat reactivity feels tight with music

### Phase 7: Text System

**Goal**: Users can add and style text layers with animations
**Depends on**: Phase 4, Phase 6
**Requirements**: TXT-01, TXT-02, TXT-03, TXT-04
**Plans**: 1

Plans:
- [x] 07-01: Text layers with animations

**Details:**
- Normalized 0-1 coordinates for responsive positioning
- Pure renderTextLayer function matching visualizer pattern
- 50px slide distance, 0.1 pulse scale factor

### Phase 8: Background System

**Goal**: Customizable backgrounds (solid, gradient, image)
**Depends on**: Phase 4
**Requirements**: BG-01, BG-02, BG-03
**Plans**: 1

Plans:
- [x] 08-01: Background system with gradients and images

**Details:**
- Background renders at layer priority 0 (behind everything)
- Linear gradient angle calculation using trigonometry
- Image backgrounds use FileReader for data URL conversion
- Gradient supports 2-4 color stops

### Phase 9: Effects

**Goal**: Visual effects including camera shake and post-processing
**Depends on**: Phase 6
**Requirements**: FX-02, FX-03, VIS-04, VIS-05
**Plans**: 1

Plans:
- [x] 09-01: Camera shake and vignette effects

**Details:**
- CSS transform for camera shake (simpler than canvas translate)
- Vignette at overlay layer priority 20
- 0.6 intensity threshold for camera shake (only strong beats)
- 8px max offset, 35% vignette intensity
- Note: Particle system was implemented but reverted per user request

### Phase 10: Presets

**Goal**: Four complete style presets with distinct visual languages
**Depends on**: Phase 5, Phase 6, Phase 7, Phase 8, Phase 9
**Requirements**: PRE-01, PRE-02, PRE-03, PRE-04, PRE-05
**Plans**: 1

Plans:
- [x] 10-01: Four preset definitions with selector UI

**Details:**
- TikTok (9:16): High energy, fast rotation, strong shake
- YouTube (16:9): Cinematic, calm, minimal text
- Lyric Video: Text-centric, soft waveform, no shake
- Club: Dark, neon cyan/magenta, max bass, rave aesthetic
- Aspect ratio via CSS aspectRatio property

### Phase 11: Export Pipeline

**Goal**: Users can export their creation as video files
**Depends on**: Phase 10, PRV-01
**Requirements**: EXP-01, EXP-02, EXP-03, EXP-04, PRV-02
**Plans**: 2

Plans:
- [x] 11-01: VideoExporter class with MediaRecorder
- [x] 11-02: ExportPanel UI integration

**Details:**
- VP9/Opus codec with 5 Mbps video bitrate
- 100ms chunk intervals for smooth progress
- Parallel audio routing (speakers + capture)
- onCanvasReady callback pattern for canvas access

### Phase 12: Platform Polish

**Goal**: Production-ready with responsive UI, offline support, and monetization
**Depends on**: Phase 11
**Requirements**: PLT-01, PLT-02, PLT-03, PLT-04
**Plans**: 3

Plans:
- [x] 12-01: PWA setup with Workbox
- [x] 12-02: Tier system (free/pro)
- [x] 12-03: Mobile responsive polish

**Details:**
- generateSW mode with autoUpdate registration
- Free tier: watermark + 720p limit
- Pro tier: no watermark + 1080p
- 44px minimum touch targets for accessibility
- Safe area insets for notched devices

---

## Milestone Summary

**Decimal Phases:** None (no urgent insertions needed)

**Key Decisions:**
- 100% client-side architecture (no server costs, privacy)
- Preset-based UX over timeline editing (lower complexity)
- Beat-reactive as core differentiator (makes visualizers feel alive)
- Canvas 2D over WebGL (simpler, sufficient for current needs)
- Energy-based beat detection (1.3x threshold feels tight)
- Reverted particle system (performance concerns, visual clutter)

**Issues Resolved:**
- React 19 lint compliance with refs during render
- Browser autoplay policy via lazy AudioContext
- Temporal flow for visualizers (not just reactive meters)

**Issues Deferred:**
- Video backgrounds (BG-04) — added complexity
- Particle effects (VIS-04) — reverted, needs performance work
- MP4 export — browser support limited

**Technical Debt Incurred:**
- None significant — clean implementation

---

_For current project status, see .planning/PROJECT.md_
